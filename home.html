<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICYXR - 3D Printable Designs</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- Firebase v9 SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.14.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.14.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.14.0/firebase-database-compat.js"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<body class="font-inter">

    <!-- Beta Banner -->
    <div id="beta-banner" class="fixed top-0 left-0 right-0 z-50 flex items-center justify-center gap-3 p-2 text-sm text-white bg-red-800/60 backdrop-blur-sm border-b border-red-500/30">
        <span class="relative flex h-2.5 w-2.5">
            <span class="absolute inline-flex w-full h-full bg-green-400 rounded-full opacity-75 animate-ping"></span>
            <span class="relative inline-flex w-2.5 h-2.5 bg-green-500 rounded-full"></span>
        </span>
        <span>We are currently in Beta. Some features may not be fully functional.</span>
    </div>


    <!-- Message Box -->
    <div id="message-box"></div>

    <!-- User Notification Box -->
    <div id="user-notification-box"></div>

    <!-- Top Header Icons -->
    <header id="top-header" class="fixed left-0 right-0 z-40 flex justify-between items-center p-4">
        <svg id="burger" class="icon burger-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="3" y1="6" x2="21" y2="6" />
            <line x1="3" y1="12" x2="21" y2="12" />
            <line x1="3" y1="18" x2="21" y2="18" />
        </svg>
        <div class="icons flex gap-5">
            <svg id="search" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <circle cx="11" cy="11" r="7" stroke-width="2"/>
                <line x1="16.65" y1="16.65" x2="21" y2="21" stroke-width="2"/>
            </svg>
            <svg id="orders-btn" class="icon hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
            </svg>
            <svg id="admin-ban-btn" class="icon hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle><line x1="4.93" y1="4.93" x2="19.07" y2="19.07"></line>
            </svg>
            <svg id="profile-btn" class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <circle cx="12" cy="8" r="4" stroke-width="2"/>
                <path d="M4 20c0-4 4-6 8-6s8 2 8 6" stroke-width="2"/>
            </svg>
        </div>
    </header>

    <!-- Title -->
    <h1 class="page-title text-5xl sm:text-7xl">ICYXR</h1>
    <h2 class="sub-title text-lg sm:text-xl">3D Printable Designs</h2>

    <!-- View Counter -->
    <div id="view-counter" class="flex items-center justify-center gap-2 mt-3 text-gray-400 hidden">
        <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
            <circle cx="12" cy="12" r="3"></circle>
        </svg>
        <span id="view-count-number" class="font-mono text-lg">0</span>
    </div>

    <!-- Sidebar -->
    <nav id="sidebar" class="sidebar">
        <button id="close-sidebar-btn" class="absolute top-2 right-4 text-4xl text-white hover:text-gray-400">&times;</button>
        <ul>
            <li id="pricing-btn">Pricing</li>
            <li id="contact-btn">Contact</li>
            <li id="viewer-btn">3D Viewer</li>
        </ul>
        <div class="discount-container">
            <label for="discount-input" class="text-xs text-gray-400 block mb-1">Redeem Discount</label>
            <input type="text" id="discount-input" placeholder="Enter Code" class="w-full p-2 rounded-lg bg-gray-800 text-white border border-gray-600 focus:border-baby-blue outline-none text-sm">
            <button id="redeem-btn" class="mt-2 w-full py-1.5 bg-white text-black text-sm font-bold rounded-lg transition hover:bg-gray-200">Redeem</button>
        </div>
        <div class="version px-4 py-3">Version 1.2.1</div>
    </nav>

    <!-- Main Content -->
    <main class="content flex flex-col items-center p-4">

        <!-- 3D Viewer Section -->
        <section id="viewer-section" class="flex flex-col items-center w-full max-w-2xl transition-opacity duration-500">
            <h2 id="model-title" class="text-2xl sm:text-3xl font-bold mb-4 text-white text-center">Interactive 3D Preview: Octahedron</h2>
            <div id="three-canvas-container">
                <canvas id="three-canvas"></canvas>
                <div class="canvas-nav">
                    <svg id="prev-model-btn" class="nav-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M15 18l-6-6 6-6"/>
                    </svg>
                    <div id="dot-0" class="nav-dot active"></div>
                    <div id="dot-1" class="nav-dot"></div>
                    <svg id="next-model-btn" class="nav-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 18l6-6-6-6"/>
                    </svg>
                </div>
            </div>
            <p class="text-sm text-gray-400 mt-2">Drag mouse/swipe to rotate the model.</p>

            <!-- Model Details Panel -->
            <div id="model-details-panel" class="w-full max-w-lg mt-8 p-4 sm:p-6 rounded-xl bg-gray-900/70 border border-baby-blue/50">
                <h3 class="text-2xl font-bold mb-4 text-baby-blue border-b border-baby-blue/30 pb-2">Print Specifications</h3>
                <div class="flex flex-col sm:flex-row justify-between items-center mb-4">
                    <label for="quality-selector" class="text-lg text-white mb-2 sm:mb-0">Print Quality:</label>
                    <select id="quality-selector" class="p-2 rounded-lg bg-gray-800 text-white border border-gray-600">
                        <option value="standard">Standard Resolution</option>
                        <option value="high">High Resolution (+$0.50)</option>
                    </select>
                </div>                
                <div class="space-y-3 text-left text-gray-200">
                    <p><strong>Material:</strong> <span id="spec-material" class="text-metallic-grey-1">PLA Filament (Recycled)</span></p>
                    <p><strong>Layer Height:</strong> <span id="spec-layer-height" class="text-metallic-grey-1">0.2mm (Standard)</span></p>
                    <p><strong>Print Time:</strong> <span id="spec-print-time" class="text-metallic-grey-1">Approx 4.5 hours</span></p>
                    <p><strong>Final Price Est.:</strong> <span id="spec-price-est" class="text-metallic-grey-1 text-lg font-bold">£5.30</span></p>
                </div>
            </div>
        </section>

        <!-- Pricing Wave -->
        <div id="pricing-wave" class="pricing-wave">
            <div class="pricing-content p-4 sm:p-6">
                <h2 class="text-3xl sm:text-4xl font-extrabold mb-6">Our Pricing</h2>
                <div class="pricing-cards flex flex-wrap justify-center gap-6">
                    <!-- Dragon Card (with Recommended label added) -->
                    <div class="pricing-card relative">
                        <span class="recommended-label">Recommended</span>
                        <h3 class="text-xl font-bold mb-2">Dragon Model</h3>
                        <p class="mb-2">High-quality 3D printable dragon figure.</p>
                        <p class="font-bold text-lg">£12.50</p>
                        <button class="mt-3 px-4 py-2 bg-baby-blue text-black rounded-lg font-bold hover:bg-white transition">Buy Now</button>
                    </div>

                    <!-- Phoenix Card -->
                    <div class="pricing-card">
                        <h3 class="text-xl font-bold mb-2">Phoenix Model</h3>
                        <p class="mb-2">Elegant 3D printable phoenix figure.</p>
                        <p class="font-bold text-lg">£10.00</p>
                        <button class="mt-3 px-4 py-2 bg-baby-blue text-black rounded-lg font-bold hover:bg-white transition">Buy Now</button>
                    </div>

                    <!-- Griffin Card -->
                    <div class="pricing-card">
                        <h3 class="text-xl font-bold mb-2">Griffin Model</h3>
                        <p class="mb-2">Detailed 3D printable griffin figure.</p>
                        <p class="font-bold text-lg">£11.20</p>
                        <button class="mt-3 px-4 py-2 bg-baby-blue text-black rounded-lg font-bold hover:bg-white transition">Buy Now</button>
                    </div>
                </div>
                <div class="mt-8">
                    <button id="purchase-btn" class="hidden px-8 py-3 bg-green-500 text-white font-bold rounded-lg transition hover:bg-green-600">Place Order (Pay with Cash)</button>
                    <button id="close-pricing-btn" class="px-6 py-2 bg-white text-black font-bold rounded-full transition hover:bg-gray-200">Close Price List</button>
                </div>
            </div>
        </div>

        <!-- Contact Form -->
        <div id="contact-form" class="contact-form">
            <h2 class="text-3xl font-bold mb-6 text-white">Contact Us</h2>
            <p class="text-center text-lg text-gray-300">
                For any inquiries, please feel free to email us directly at:
                <br>
                <a href="mailto:icyxrr@gmail.com" class="text-baby-blue hover:underline font-semibold mt-2 inline-block">icyxrr@gmail.com</a>
            </p>
        </div>

        <!-- Login Form Card -->
        <div id="login-form-card" class="hidden w-full max-w-md p-6 rounded-xl bg-gray-900/80 border border-baby-blue/50 flex-col items-center gap-4">
            <h2 class="text-2xl font-bold text-baby-blue">Login or Sign Up</h2>
            <div class="w-full">
                <label for="email-input" class="text-sm text-gray-300">Email</label>
                <input type="email" id="email-input" placeholder="you@example.com" class="w-full p-2 mt-1 rounded-lg bg-gray-800 text-white border border-gray-600 focus:border-baby-blue outline-none">
            </div>
            <div class="w-full">
                <label for="password-input" class="text-sm text-gray-300">Password</label>
                <input type="password" id="password-input" placeholder="••••••••" class="w-full p-2 mt-1 rounded-lg bg-gray-800 text-white border border-gray-600 focus:border-baby-blue outline-none">
            </div>
            <div class="flex gap-4 mt-2">
                <button id="signin-btn" class="px-6 py-2 bg-baby-blue text-black font-bold rounded-lg transition hover:bg-white">Sign In</button>
                <button id="signup-btn" class="px-6 py-2 bg-transparent border border-baby-blue text-baby-blue font-bold rounded-lg transition hover:bg-baby-blue/10">Sign Up</button>
            </div>
        </div>

        <!-- User Profile Card -->
        <div id="user-profile-card" class="employee-card flex flex-col items-center gap-4 p-4 rounded-xl hidden">
            <div class="employee-icon">
                <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="8" r="4" />
                    <path d="M4 20c0-4 4-6 8-6s8 2 8 6" />
                </svg>
            </div>
            <div class="employee-info text-center">
                <div id="author-name-display" class="employee-name text-xl">Guest</div>
                <div class="mt-2">
                    <label for="author-name-input" class="text-xs text-gray-400">Edit your name:</label>
                    <input type="text" id="author-name-input" class="w-full p-2 mt-1 rounded-lg bg-gray-700 text-white border border-gray-600 focus:border-baby-blue outline-none text-sm" placeholder="Enter new name...">
                </div>

                <div class="employee-role text-sm mt-2 text-gray-400">Email:</div>
                <div class="flex items-center justify-center gap-2 mt-1">
                    <div id="user-email-display" class="text-sm font-mono break-all text-white"></div>
                    <span id="user-verified-badge" class="verified-badge hidden">✓</span>
                    <button id="logout-btn"></button>
                </div>
                <button id="copy-id-btn" class="mt-2 text-xs text-gray-400 hover:text-white">Copy User ID</button>
            </div>
        </div>

        <!-- Employee Cards Container -->
        <div id="employee-cards-container" class="w-full max-w-4xl flex flex-row flex-wrap justify-center gap-4 mt-4"></div>

    </main>

    <!-- Main JS -->
    <script src="firebase-init.js"></script>
    <script src="main.js"></script>

    <!-- Customer Service Button -->
    <button id="customer-service-btn" class="customer-service-btn">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
        </svg>
    </button>

    <!-- Feedback Modal -->
    <div id="feedback-modal" class="feedback-modal hidden">
        <div class="feedback-form-content">
            <button id="close-feedback-btn" class="absolute top-2 right-3 text-3xl text-gray-400 hover:text-white">&times;</button>
            <div id="support-chat-widget" class="text-left">
                <div class="flex items-center gap-3 mb-4">
                    <div class="bot-icon">
                        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zM8 11.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5-1.5-.67-1.5-1.5.67-1.5 1.5-1.5zm8 0c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5-1.5-.67-1.5-1.5.67-1.5 1.5-1.5zm-4-3c-2.33 0-4.31 1.46-5.11 3.5h10.22c-.8-2.04-2.78-3.5-5.11-3.5z"></path></svg>
                    </div>
                    <h2 class="text-2xl font-bold text-baby-blue">Support Bot</h2>
                </div>
                <div id="support-chat-messages" class="space-y-3 mt-4 h-48 overflow-y-auto p-2 bg-gray-900/50 rounded-lg">
                    <!-- Messages will appear here -->
                </div>
                <div id="support-input-area" class="hidden mt-4">
                    <textarea id="support-input" placeholder="Type your problem here..." class="w-full p-2 rounded-lg bg-gray-800 text-white border border-gray-600 resize-none" rows="3"></textarea>
                    <button id="send-support-message-btn" class="w-full mt-2 py-2 bg-baby-blue text-black font-bold rounded-lg transition hover:bg-white">Send</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Sign-up Prompt Modal -->
    <div id="signup-prompt-modal" class="feedback-modal hidden">
        <div class="signup-prompt-content">
            <h2 class="text-2xl font-bold text-red-400 mb-4">Access Restricted</h2>
            <p class="text-lg text-gray-300 mb-8">
                You are not signed up. Would you like to create an account to access pricing?
            </p>
            <div class="flex gap-6 justify-center">
                <button id="signup-prompt-yes" class="px-8 py-2 bg-green-600 text-white font-bold rounded-lg transition hover:bg-green-700">Yes</button>
                <button id="signup-prompt-no" class="px-8 py-2 bg-red-700 text-white font-bold rounded-lg transition hover:bg-red-800">No</button>
            </div>
        </div>
    </div>

    <!-- Orders Panel (Admin) -->
    <div id="orders-panel" class="feedback-modal hidden">
        <div class="feedback-form-content">
            <button id="close-orders-btn" class="absolute top-2 right-3 text-3xl text-gray-400 hover:text-white">&times;</button>
            <h2 class="text-2xl font-bold text-baby-blue mb-4">Customer Orders</h2>
            <div id="orders-list" class="space-y-4 max-h-[70vh] overflow-y-auto p-2 bg-gray-900/50 rounded-lg">
                <!-- Orders will be rendered here -->
            </div>
        </div>
    </div>

    <!-- Admin Ban Panel -->
    <div id="admin-ban-panel" class="feedback-modal hidden">
        <div class="admin-ban-content">
            <button id="close-admin-ban-btn" class="absolute top-2 right-3 text-3xl text-gray-400 hover:text-white">&times;</button>
            <h2 class="text-2xl font-bold text-red-400 mb-4">Ban a User</h2>
            <div class="space-y-4 text-left">
                <div>
                    <label for="ban-user-select" class="text-sm text-gray-300">Choose a user:</label>
                    <select id="ban-user-select" class="w-full p-2 mt-1 rounded-lg bg-gray-800 text-white border border-gray-600"></select>
                </div>
                <div>
                    <label for="ban-reason-input" class="text-sm text-gray-300">Reason:</label>
                    <textarea id="ban-reason-input" rows="3" placeholder="Reason for the ban..." class="w-full p-2 mt-1 rounded-lg bg-gray-800 text-white border border-gray-600 resize-none"></textarea>
                </div>
                <!-- For now, we will implement permanent bans as requested -->
                <input type="hidden" id="ban-duration-input" value="permanent">
            </div>
            <button id="execute-ban-btn" class="w-full mt-6 py-2 bg-red-800 text-white font-bold rounded-lg transition hover:bg-red-900">Issue Permanent Ban</button>
        </div>
    </div>

    <!-- Banned User Alert Panel -->
    <div id="banned-user-panel" class="feedback-modal hidden">
        <div class="banned-user-content">
            <h2 class="text-3xl font-bold text-red-400 mb-4">Account Suspended</h2>
            <p id="ban-reason-display" class="text-lg text-gray-300">
                Reason: Loading...
            </p>
            <p class="text-sm text-gray-400 mt-4">Please contact a staff member for assistance.</p>
        </div>
    </div>

</body>
</html>